UNSET(LIB_LIST)
UNSET(LIB_PROJ_LIST)
SUBDIRLIST(LIB_LIST ${SOURCE_PATH})
FOREACH(ITER ${LIB_LIST})	
	UNSET(LIB_FILE_LIST)
	UNSET(LIB_FILE_PATHS)
	LIST(APPEND LIB_FILE_PATHS ${SOURCE_PATH}/${ITER})
	SEARCH_FILES(LIB_FILE_LIST ${ITER} LIB_FILE_PATHS)
	ADD_LIBRARY(${ITER}_shared SHARED ${LIB_FILE_LIST})
	LIST(APPEND LIB_PROJ_LIST ${ITER}_shared)
	STRING(TOUPPER ${ITER} ITER_UPPER)
	TARGET_COMPILE_DEFINITIONS(${ITER}_shared PRIVATE BUILD_SHARED_LIB ${ITER_UPPER}_EXPORTS)
	SET_TARGET_PROPERTIES(${ITER}_shared PROPERTIES FOLDER "Shared")
	ADD_PRECOMPILED_HEADER(${ITER}_shared LIB_FILE_LIST "stdafx")
	TARGET_LINK_LIBRARIES(${ITER}_shared fcontext)
ENDFOREACH()

UNSET(TEST_LIST)
SUBDIRLIST(TEST_LIST ${TEST_PATH})
FOREACH(ITER ${TEST_LIST})
	UNSET(TEST_FILE_PATH)
	LIST(APPEND TEST_FILE_PATH ${TEST_PATH}/${ITER})
	SEARCH_FILES(TEST_FILE_LIST ${ITER} TEST_FILE_PATH)
	ADD_EXECUTABLE(${ITER}_shared ${TEST_FILE_LIST})
	TARGET_COMPILE_DEFINITIONS(${ITER}_shared PRIVATE BUILD_SHARED_LIB)
	TARGET_LINK_LIBRARIES(${ITER}_shared ${LIB_PROJ_LIST})
	IF(NOT MSVC)
		TARGET_LINK_LIBRARIES(${ITER}_shared pthread)
	ENDIF()
	SET_TARGET_PROPERTIES(${ITER}_shared PROPERTIES FOLDER "Shared/Test")
	ADD_PRECOMPILED_HEADER(${ITER}_shared TEST_FILE_LIST "stdafx")
ENDFOREACH()
